<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>EPUB ë‹¤ìš´ë¡œë“œ í—ˆë¸Œ</title>
  <style>
    :root { --bg:#0f172a; --card:#111827; --muted:#94a3b8; --text:#e2e8f0; --accent:#22c55e; --accent2:#60a5fa; }
    *{box-sizing:border-box}
    body{margin:0;padding:16px;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial}
    h1{font-size:22px;margin:0 0 12px 0}
    .card{background:var(--card);border-radius:14px;padding:14px;margin:10px 0;box-shadow:0 8px 24px rgba(0,0,0,0.25)}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .row>*{flex:1 1 160px;min-width:160px}
    input,select{width:100%;padding:12px;background:#0b1220;color:var(--text);border:1px solid #1f2937;border-radius:10px;outline:none}
    input:focus,select:focus{border-color:var(--accent2)}
    .btn{display:inline-block;padding:10px 14px;background:var(--accent);color:#052e13;border-radius:10px;text-decoration:none;font-weight:700}
    .btn.alt{background:#0b1220;color:var(--text);border:1px solid #1f2937;margin-left:6px}
    .entry{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px;border:1px solid #1f2937;border-radius:12px;margin:8px 0;background:#0b1220}
    .title{font-weight:700}
    .muted{color:var(--muted);font-size:12px}
    .footer{text-align:center;color:var(--muted);margin-top:20px;font-size:12px}
  </style>
</head>
<body>
  <h1>2025 ì„œìš¸ë™í–‰ì¸ë¬¸í•™</h1>
  <h1>(í•œì‚¬ëŒì„ ìœ„í•œ ë¯¸ìˆ ì¸ë¬¸í•™) ê°œì¸ì„ ë„˜ì–´ ìš°ë¦¬ : AIë¥¼ í™œìš©í•œ ê¸€ê³¼ ê·¸ë¦¼ì±… ìˆ˜ì—…</h1>
  <h3>ğŸ“š ì „ìì±…(EPUB) ë‹¤ìš´ë¡œë“œ í—ˆë¸Œ</h3>
  <h3>ğŸ“š ì „ìì±… ë‹¤ìš´ë¡œë“œëŠ” 2025ë…„ 10ì›” 10ì¼ê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</h3>

  <div class="card">
    <div class="row">
      <div>
        <label class="muted">ì‘ê°€ ì„ íƒ</label>
        <select id="lecturerSelect"></select>
      </div>
      <div>
        <label class="muted">ê²€ìƒ‰ (ì‘í’ˆëª…/ì†Œì†/ì‘ê°€ëª…)</label>
        <input id="searchInput" type="search" placeholder="ì˜ˆ) ìœ¤ë™ì£¼"/>
      </div>
    </div>
  </div>

  <div id="listArea"></div>

  <div class="footer">
    ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€ ìœµë³µí•© ì¸ì¬êµìœ¡ì„¼í„°<br/>
  </div>

<script>
const DATASET = [
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"êµ¬í¬ì§„", "ì‘í’ˆëª…":"Stage in the FOREST ìˆ²ì† ë¬´ëŒ€",  "íŒŒì¼ë§í¬":"epub/êµ¬í¬ì§„ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ê¹€ë¯¸ì—°", "ì‘í’ˆëª…":"í¬ë§ì•ˆì—ì„œ", "íŒŒì¼ë§í¬":"epub/ê¹€ë¯¸ì—°ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ê¹€ì€ì§„", "ì‘í’ˆëª…":"ê½ƒì€, ë‹¤ì‹œ í•€ë‹¤", "íŒŒì¼ë§í¬":"epub/ê¹€ì€ì§„ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ê¹€ì¡°ì„¸ë¦°", "ì‘í’ˆëª…":"ì˜¤ëŠ˜ì˜ ë‚˜ë¥¼ ë§Œë“  ì–´ì œì˜ ìˆ¨ê²°", "íŒŒì¼ë§í¬":"epub/ê¹€ì¡°ì„¸ë¦°ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ë°•ì§„ê²½", "ì‘í’ˆëª…":"ê³ í†µì„ ë„˜ì–´ í¬ë§ìœ¼ë¡œ", "íŒŒì¼ë§í¬":"epub/ë°•ì§„ê²½ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ì˜¤ì§„ê²½", "ì‘í’ˆëª…":"ìŠ¤ì³ê°„ ìˆœê°„ë“¤ì´ ëª¨ì—¬ ë‚´ ì•ˆì— ê¸¸ì„ ë†“ì•˜ë‹¤", "íŒŒì¼ë§í¬":"epub/ì˜¤ì§„ê²½ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ì´ì„ í™”", "ì‘í’ˆëª…":"ë‹¬íŒ½ì´ì˜ ì•„ì¹¨.ì €ë… ê·¸ë¦¬ê³ .ì§€ê¸ˆ", "íŒŒì¼ë§í¬":"epub/ì´ì„ í™”ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ì´ì¬í™", "ì‘í’ˆëª…":"í—ˆìš°ì ê±°ë¦¬ë©° ë°°ìš°ë‹¤", "íŒŒì¼ë§í¬":"epub/ì´ì¬í™ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ì´ì •ì€", "ì‘í’ˆëª…":"ì‚¶ì„ ì‡ëŠ” ì‘ì€ ì‹¤", "íŒŒì¼ë§í¬":"epub/ì´ì •ì€ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ì¥ì˜ìˆ™", "ì‘í’ˆëª…":"ê´œì°®ì•„, ì˜¤ëŠ˜ë„... ê´œì°®ì•„, ë‚´ì¼ë„...", "íŒŒì¼ë§í¬":"epub/ì¥ì˜ìˆ™ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ì •ì—°ê²½", "ì‘í’ˆëª…":"60+ ì‚¶ì„ í–¥í•œ ê¹Šì€ ë¿Œë¦¬ì™€ ìƒˆë¡œìš´ ê°€ì¹˜", "íŒŒì¼ë§í¬":"epub/ì •ì—°ê²½ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ì •í˜œìš±", "ì‘í’ˆëª…":"ì‚¶ì€ ì—¬í–‰ì´ê³ , ë‚˜ëŠ” ì—¬ì „íˆ ê¸¸ìœ„ì— ìˆë‹¤.", "íŒŒì¼ë§í¬":"epub/ì •í˜œìš±ì‘ê°€_f.epub" },
  { "ì†Œì†":"ì„œëŒ€ë¬¸êµ¬ í‰ìƒí•™ìŠµê´€", "ì‘ê°€ëª…":"ì¡°ë¯¸ì˜", "ì‘í’ˆëª…":"ìˆ¨ë¹› Breathing light", "íŒŒì¼ë§í¬":"epub/ì¡°ë¯¸ì˜ì‘ê°€_f.epub" }
];

// ê³ ìœ  ì‘ê°€ëª… ë¦¬ìŠ¤íŠ¸
function getLecturers(){
  const set = new Set(DATASET.map(x => x["ì‘ê°€ëª…"]));
  return ["(ì „ì²´)"].concat([...set].sort());
}

function renderLecturerOptions(){
  const sel = document.getElementById("lecturerSelect");
  sel.innerHTML = "";
  getLecturers().forEach(name => {
    const opt = document.createElement("option");
    opt.value = name;
    opt.textContent = name;
    sel.appendChild(opt);
  });
  const q = new URLSearchParams(location.search).get("lecturer");
  if(q) sel.value = q;
}

function renderList(){
  const area = document.getElementById("listArea");
  const lecturer = document.getElementById("lecturerSelect").value;
  const q = document.getElementById("searchInput").value.trim().toLowerCase();
  const repoName = location.pathname.split("/")[1]; // "epub-hub"

  let arr = DATASET.slice();
  if(lecturer && lecturer !== "(ì „ì²´)") arr = arr.filter(x => x["ì‘ê°€ëª…"]===lecturer);
  if(q){
    arr = arr.filter(x =>
      (x["ì‘í’ˆëª…"]||"").toLowerCase().includes(q) ||
      (x["ì†Œì†"]||"").toLowerCase().includes(q) ||
      (x["ì‘ê°€ëª…"]||"").toLowerCase().includes(q)
    );
  }

  area.innerHTML = "";
  if(arr.length===0){
    area.innerHTML = '<div class="card muted">ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
    return;
  }

  const byLect = arr.reduce((acc,cur)=>{
    const key = cur["ì‘ê°€ëª…"]||"ë¯¸ì§€ì •";
    (acc[key] ||= []).push(cur);
    return acc;
  },{});

  Object.keys(byLect).sort().forEach(lect => {
    const group = byLect[lect];
    const card = document.createElement("div");
    card.className = "card";
    const header = document.createElement("div");
    header.innerHTML = '<div class="title">ğŸ‘¤ '+escapeHtml(lect)+'</div><div class="muted">'+group.length+'ê°œ í•­ëª©</div>';
    card.appendChild(header);

    group.forEach(item => {
      const row = document.createElement("div");
      row.className = "entry";
      const title = escapeHtml(item["ì‘í’ˆëª…"]||"");
      const org = escapeHtml(item["ì†Œì†"]||"");
      const raw = (item["íŒŒì¼ë§í¬"]||"").trim();

      row.innerHTML = `
        <div>
          <div class="title">${title}</div>
          <div class="muted">${org}</div>
        </div>
        <div class="actions"></div>
      `;

      const actions = row.querySelector('.actions');

      // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼
      const dl = document.createElement('a');
      dl.className = 'btn';
      dl.href = raw;
      dl.target = '_blank';
      dl.rel = 'noopener';
      dl.textContent = 'ë‹¤ìš´ë¡œë“œ';
      actions.appendChild(dl);

      // âœ… ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼
      let u = null;
      try { u = new URL(raw, location.href); } catch (e) {}
      const isSameOrigin = u && u.origin === location.origin;
      const p = u ? u.pathname.toLowerCase() : "";
      const looksLikeEpub = p.includes("/epub/") && p.endsWith(".epub");

      if (isSameOrigin && looksLikeEpub) {
        let relative = raw.replace(/^\//, "");
        if (relative.startsWith(repoName + "/")) {
          relative = relative.substring(repoName.length + 1);
        }
        const pv = document.createElement('a');
        pv.className = 'btn alt';
        pv.href = 'viewer.html?book=' + encodeURIComponent(relative);
        pv.target = '_blank';
        pv.rel = 'noopener';
        pv.textContent = 'ë¯¸ë¦¬ë³´ê¸°';
        actions.appendChild(pv);
      }

      card.appendChild(row);
    });

    area.appendChild(card);
  });
}

function escapeHtml(s){
  return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;");
}

document.getElementById("lecturerSelect").addEventListener("change", renderList);
document.getElementById("searchInput").addEventListener("input", renderList);

renderLecturerOptions();
renderList();
</script>
</body>
</html>
